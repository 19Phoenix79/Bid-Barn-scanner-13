<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Sir Scansalot 2.0 ‚Äì Bid Barn</title>
  <link rel="stylesheet" href="./styles.css" />
  <!-- PapaParse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <header class="top">
    <div class="brand">
      <h1>üëë Sir Scansalot 2.0</h1>
    </div>
    <div class="statbar">
      <div>Total Items: <strong id="statTotalItems">0</strong></div>
      <div>Total Cost (Truck + Shipping + Fees): $<strong id="statTotalCost">0.00</strong></div>
      <div>Cost Per Item (CPI): $<strong id="statCPI">0.00</strong></div>
    </div>
  </header>

  <main class="wrap">
    <!-- Truck / Cost Section -->
    <section class="card">
      <h2>1. Truck / Cost Info</h2>
      <div class="grid2">
        <div class="row">
          <label>Total Truck Cost ($)</label>
          <input id="truckCost" type="number" step="0.01" placeholder="e.g. 12000.00" />
        </div>
        <div class="row">
          <label>Shipping Cost ($)</label>
          <input id="shippingCost" type="number" step="0.01" placeholder="e.g. 1500.00" />
        </div>
        <div class="row">
          <label>Other Fees ($)</label>
          <input id="otherFees" type="number" step="0.01" placeholder="e.g. 300.00" />
        </div>
        <div class="row">
          <label>Notes / Truck Name</label>
          <input id="truckLabel" type="text" placeholder="e.g. WTL ‚Äì Kitchen & Bath 27 Pallets" />
        </div>
      </div>
      <div class="row gap">
        <button id="btnSaveSession" class="btn primary">Save Cost Info</button>
        <button id="btnNewSession" class="btn">Start New Session</button>
      </div>
      <div class="small">
        CPI = (Truck Cost + Shipping + Other Fees) √∑ Total Units on Manifest.<br />
        We‚Äôll recompute CPI every time you change costs or import a new manifest.
      </div>
    </section>

    <!-- Manifest Upload -->
    <section class="card">
      <h2>2. Upload Manifest CSV</h2>
      <p class="small">
        Expected columns: <b>SKU</b> and <b>Retail</b> are required. Optional: <b>Title</b>, <b>Qty</b>.<br />
        Example headers: <code>SKU,Title,Retail,Qty</code>
      </p>
      <div class="row gap">
        <button id="btnManifest" class="btn">üì• Choose Manifest CSV</button>
        <input id="manifestFile" type="file" accept=".csv" style="display:none" />
        <button id="btnClearItems" class="btn danger">üóë Clear All Items</button>
      </div>
      <div class="small">
        After import, CPI will be applied to every item. You can still tweak costs and re-export.
      </div>
    </section>

    <!-- Items Table -->
    <section class="card">
      <h2>3. Items & Photos</h2>
      <div class="table-wrap">
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>SKU</th>
              <th>Title</th>
              <th>Retail</th>
              <th>Qty</th>
              <th>CPI (Cost / Item)</th>
              <th>Auction Start</th>
              <th>Photo</th>
            </tr>
          </thead>
          <tbody id="itemsBody"></tbody>
        </table>
      </div>
      <div class="small">
        CPI is shared across items. Auction Start defaults to CPI; you can override per item.<br />
        Click ‚ÄúAdd Photo‚Äù to take/upload a picture for that SKU.
      </div>
    </section>

    <!-- Export -->
    <section class="card">
      <h2>4. Export Bid Barn CSV for WooCommerce</h2>
      <p class="small">
        This creates a CSV with columns suitable for All Import / All Export.<br />
        <b>Images</b> column will contain a suggested filename (e.g. <code>123456789012.jpg</code>).<br />
        After exporting, save your photos with those filenames and upload them to WordPress.
      </p>
      <div class="row gap">
        <button id="btnExportCSV" class="btn primary">‚¨áÔ∏è Export Bid Barn CSV</button>
      </div>
    </section>
  </main>

  <div id="toast"></div>

  <footer class="top">
    <div class="small">¬© 2025 Bid Barn ‚Äì Sir Scansalot 2.0</div>
  </footer>

  <script src="./app.js"></script>
</body>
</html>